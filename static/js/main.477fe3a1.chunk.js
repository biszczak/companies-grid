(this["webpackJsonpcompanies-grid"]=this["webpackJsonpcompanies-grid"]||[]).push([[0],{19:function(e,t,a){e.exports=a(37)},24:function(e,t,a){},26:function(e,t,a){},27:function(e,t,a){},28:function(e,t,a){},29:function(e,t,a){},30:function(e,t,a){},31:function(e,t,a){},32:function(e,t,a){},33:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(17),c=a.n(o),s=(a(24),a(15)),l=a(9),i=a.n(l),m=a(13),u=a(7),d=a(10),h=a(11),p=a(2),g=a(3),f=a(8),y=a(5),v=a(4),b=a(18),E=(a(26),function(e){return r.a.createElement("div",{className:"search-wrapper"},r.a.createElement("input",{disabled:!e.data,type:"text",placeholder:"Search...",onChange:e.handleChange}),r.a.createElement(b.a,{className:"search-icon"}))}),P=(a(27),function(e){return r.a.createElement("div",{className:"heading"},r.a.createElement("h1",{className:"title"},"Companies"),r.a.createElement(E,{handleChange:e.handleChange,data:e.data}))}),w=(a(28),function(e){var t=[{id:"elem1",name:"Id",sortBy:"id",icon:e.sortSymbol.id},{id:"elem2",name:"Name",sortBy:"name",icon:e.sortSymbol.name},{id:"elem3",name:"City",sortBy:"city",icon:e.sortSymbol.city},{id:"elem4",name:"Total income",sortBy:"companyTotalIncome",icon:e.sortSymbol.companyTotalIncome},{id:"elem5",name:"Average income",sortBy:"averageIncome",icon:e.sortSymbol.averageIncome},{id:"elem6",name:"Last month income",sortBy:"lastMonthIncome",icon:e.sortSymbol.lastMonthIncome}];return r.a.createElement("tr",{className:"data-table__row"},t.map((function(t){return r.a.createElement("th",{key:t.id},r.a.createElement("button",{className:"sort-button",onClick:function(){return e.sortBy(t.sortBy)}},t.name))})))}),I=(a(29),function(e){return r.a.createElement(n.Fragment,null,r.a.createElement("thead",{className:"table-header"},r.a.createElement(w,{sortBy:e.sortBy,sortSymbol:e.sortSymbol})))}),S=(a(30),function(){return r.a.createElement("tr",{className:"loader"})}),j=(a(31),function(e){Object(y.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:e.props.data,loading:!0},e}return Object(g.a)(a,[{key:"render",value:function(){var e;return e=this.props.data?0===this.props.data.length?r.a.createElement("tr",{className:"no-results"},r.a.createElement("td",null,r.a.createElement("p",null,"No search results"))):this.props.data.map((function(e){return r.a.createElement("tr",{key:e.id,className:"table-row"},r.a.createElement("td",{"data-title":"id"},e.id),r.a.createElement("td",{"data-title":"name"},e.name),r.a.createElement("td",{"data-title":"city"},e.city),r.a.createElement("td",{"data-title":"companyTotalIncome"},e.companyTotalIncome),r.a.createElement("td",{"data-title":"averageIncome"},e.averageIncome),r.a.createElement("td",{"data-title":"lastMonthIncome"},e.lastMonthIncome))})):r.a.createElement(S,null),r.a.createElement(n.Fragment,null,e)}}]),a}(n.Component)),C=(a(32),function(e){return r.a.createElement("tbody",{className:"table-body"},r.a.createElement(j,{data:e.data}))}),O=(a(33),function(e){Object(y.a)(a,e);var t=Object(v.a)(a);function a(){var e;Object(p.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={},e}return Object(g.a)(a,[{key:"render",value:function(){return r.a.createElement("table",{className:"data-table"},r.a.createElement(I,{sortBy:this.props.sortBy,sortSymbol:this.props.sortSymbol}),r.a.createElement(C,{data:this.props.data}))}}]),a}(n.Component)),B=a(14),D=(a(34),function(e){for(var t=[],a=1;a<=Math.ceil(e.dataLength/e.rowsPerPage);a++)t.push(a);var o=t.length,c=r.a.createElement("div",{className:"footer-container"},r.a.createElement("div",{className:"records-number"},r.a.createElement("p",null,"Elements on page: "),r.a.createElement("select",{onChange:e.handleSelectRowsPerPage,value:e.rowsPerPage},r.a.createElement("option",{value:"10"},"10"),r.a.createElement("option",{value:"20"},"20"),r.a.createElement("option",{value:"50"},"50"),r.a.createElement("option",{value:"100"},"100"))),r.a.createElement("div",{className:"pages-counter"},r.a.createElement("button",{onClick:e.handlePaginationPageDecrease},r.a.createElement(B.a,null)),r.a.createElement("p",null,e.currentPage," of ",t.length),r.a.createElement("button",{onClick:function(){return e.handlePaginationPageIncrease(o)}},r.a.createElement(B.b,null))));return r.a.createElement(n.Fragment,null,e.dataLength?c:null)}),k=(a(35),function(e){Object(y.a)(a,e);var t=Object(v.a)(a);function a(e){var n;return Object(p.a)(this,a),(n=t.call(this,e)).handleSelectRowsPerPage=function(e){n.setState({currentPage:1,rowsPerPage:e.target.value})},n.handlePaginationPageIncrease=function(e){var t=n.state.currentPage;t<e&&n.setState({currentPage:t+1})},n.handlePaginationPageDecrease=function(){var e=n.state.currentPage;e>1&&n.setState({currentPage:e-1})},n.handleSearchChange=function(e){n.setState({searchInput:e.target.value},(function(){n.globalSearch()}))},n.globalSearch=function(){var e=n.state,t=e.searchInput,a=e.dataForFilter.filter((function(e){return e.name.toLowerCase().includes(t.toLowerCase())||e.city.toLowerCase().includes(t.toLowerCase())||e.id.toString().toLowerCase().includes(t.toLowerCase())||e.averageIncome.toLowerCase().includes(t.toLowerCase())||e.companyTotalIncome.toLowerCase().includes(t.toLowerCase())||e.lastMonthIncome.toLowerCase().includes(t.toLowerCase())}));n.setState({currentPage:1,data:a,sortDirection:{id:"asc",name:"asc",companyTotalIncome:"asc",averageIncome:"asc",lastMonthIncome:"asc",city:"asc"}})},n.state={data:null,dataForFilter:null,columns:[],searchInput:"",sortDirection:{id:"asc",name:"asc",companyTotalIncome:"asc",averageIncome:"asc",lastMonthIncome:"asc",city:"asc"},currentPage:1,rowsPerPage:20},n.compareBy=n.compareBy.bind(Object(f.a)(n)),n.sortBy=n.sortBy.bind(Object(f.a)(n)),n}return Object(g.a)(a,[{key:"componentDidMount",value:function(){this.getCompaniesData()}},{key:"compareBy",value:function(e){return"asc"===this.state.sortDirection[e]?function(t,a){return t[e]<a[e]?-1:t[e]>a[e]?1:0}:function(t,a){return a[e]<t[e]?-1:a[e]>t[e]?1:0}}},{key:"sortBy",value:function(e){var t,a=this,n={id:"asc",name:"asc",companyTotalIncome:"asc",averageIncome:"asc",lastMonthIncome:"asc",city:"asc"};t=this.state.filteredData?Object(h.a)(this.state.filteredData):Object(h.a)(this.state.data),"id"===e||"companyTotalIncome"===e||"averageIncome"===e||"lastMonthIncome"===e?(t.sort((function(t,n){return"asc"===a.state.sortDirection[e]?parseFloat(t[e])-parseFloat(n[e]):parseFloat(n[e])-parseFloat(t[e])})),this.setState({data:t,sortDirection:Object(d.a)(Object(d.a)({},n),{},Object(u.a)({},e,"asc"===this.state.sortDirection[e]?"desc":"asc"))})):(t.sort(this.compareBy(e)),this.setState({data:t,sortDirection:Object(d.a)(Object(d.a)({},n),{},Object(u.a)({},e,"asc"===this.state.sortDirection[e]?"desc":"asc"))}))}},{key:"getData",value:function(){var e=Object(m.a)(i.a.mark((function e(t){var a,n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t);case 2:return a=e.sent,e.next=5,a.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getLastMonthIncome",value:function(e){var t=new Date((new Date).setDate(0)).toISOString().split(/T|:|-/),a=Object(s.a)(t,2),n=a[0],r=a[1],o=0;return e.forEach((function(e){var t=e.date.split(/T|:|-/),a=Object(s.a)(t,2),c=a[0],l=a[1];n+r===c+l&&(o+=parseFloat(e.value))})),o.toFixed(2)}},{key:"getCompaniesData",value:function(){var e=Object(m.a)(i.a.mark((function e(){var t,a,n,r=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData("https://recruitment.hal.skygate.io/companies");case 2:t=e.sent,a=Object(h.a)(t),n=Object(h.a)(a),Promise.all(a.map((function(e,t){return fetch("".concat("https://recruitment.hal.skygate.io/incomes","/").concat(e.id))}))).then((function(e){return Promise.all(e.map((function(e){return e.json()})))})).then((function(e){var t=[];n.forEach((function(a,n){e.forEach((function(e){if(a.id===e.id){var n=e.incomes.reduce((function(e,t){return e+parseFloat(t.value)}),0),o=(n/e.incomes.length).toFixed(2),c=r.getLastMonthIncome(e.incomes),s={id:a.id,name:a.name,city:a.city,companyTotalIncome:n.toFixed(2),averageIncome:o,lastMonthIncome:c};t.push(s)}}))})),r.setState({data:t,dataForFilter:t})}));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.data,a=e.currentPage,n=e.rowsPerPage,o=e.sortDirection,c=a*n,s=c-n,l=t?t.slice(s,c):null;return r.a.createElement("div",{className:"table-wrapper"},r.a.createElement(P,{handleChange:this.handleSearchChange,data:l}),r.a.createElement(O,{data:l,sortBy:this.sortBy,sortSymbol:o}),r.a.createElement(D,{dataLength:t?t.length:null,rowsPerPage:n,currentPage:a,handleSelectRowsPerPage:this.handleSelectRowsPerPage,handlePaginationPageIncrease:this.handlePaginationPageIncrease,handlePaginationPageDecrease:this.handlePaginationPageDecrease}))}}]),a}(n.Component));a(36);var N=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(k,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[19,1,2]]]);
//# sourceMappingURL=main.477fe3a1.chunk.js.map